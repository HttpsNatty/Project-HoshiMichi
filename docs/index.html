<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <title>MoonKata</title>
    <link rel="icon"
        href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='0.9em' font-size='90'>üåô</text></svg>">
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: "Segoe UI", sans-serif;
            background: #0a0f24;
            overflow: hidden;
            color: white;
            text-align: center;
        }

        .stars {
            width: 2px;
            height: 2px;
            background: white;
            position: absolute;
            animation: twinkle 2s infinite ease-in-out;
            opacity: 0.8;
        }

        @keyframes twinkle {
            0% {
                opacity: 0.3;
            }

            50% {
                opacity: 1;
            }

            100% {
                opacity: 0.3;
            }
        }

        .container {
            position: relative;
            z-index: 100;
            margin-top: 40px;
        }

        .card {
            background: rgba(255, 255, 255, 0.1);
            padding: 40px;
            border-radius: 20px;
            backdrop-filter: blur(8px);
            width: 320px;
            margin: auto;
            font-size: 1.5rem;
            min-height: 150px;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            transition: 0.3s;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .card:hover {
            background: rgba(255, 255, 255, 0.18);
        }

        button {
            background: #1e2d5a;
            border: none;
            padding: 10px 20px;
            margin: 15px;
            border-radius: 10px;
            cursor: pointer;
            color: white;
            font-size: 1rem;
            transition: 0.2s;
        }

        button:hover {
            background: #2d47a1;
        }

        .tab-container {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }

        .tab-btn {
            background: rgba(30, 45, 90, 0.6);
            border: 1px solid rgba(255, 255, 255, 0.1);
            padding: 12px 24px;
            border-radius: 50px;
            cursor: pointer;
            color: #b0b8d4;
            font-size: 1.1rem;
            transition: 0.3s;
        }

        .tab-btn:hover {
            background: rgba(45, 71, 161, 0.4);
            color: white;
            transform: translateY(-2px);
        }

        .tab-btn.active {
            background: #4556a1;
            color: white;
            border-color: #7a8ce4;
            box-shadow: 0 0 20px rgba(69, 86, 161, 0.6);
            transform: scale(1.05);
        }

        .options-container {
            display: none;
            justify-content: center;
            gap: 20px;
            margin-bottom: 20px;
            color: #b0b8d4;
            font-size: 1.1rem;
        }

        .options-container.visible {
            display: flex;
        }

        .options-container label {
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
        }

        .options-container input[type="checkbox"] {
            accent-color: #4556a1;
            width: 18px;
            height: 18px;
            cursor: pointer;
        }
    </style>
</head>

<body>

    <div id="starfield"></div>

    <div class="container">
        <h1>üåô MoonKata ‚Ä¢ Flashcards de Japon√™s</h1>

        <div class="tab-container">
            <button class="tab-btn active" onclick="mudarCategoria('letras', this)">üìñ Letras</button>
            <button class="tab-btn" onclick="mudarCategoria('vocabul√°rio', this)">üìñ Vocabul√°rio</button>
            <button class="tab-btn" onclick="mudarCategoria('perguntas', this)">‚ùì Perguntas</button>
            <button class="tab-btn" onclick="mudarCategoria('descanso', this)">‚òï Descanso</button>
        </div>

        <div class="options-container visible" id="letras-options">
            <label><input type="checkbox" id="check-hiragana" checked onchange="loadCategory()"> Hiragana</label>
            <label><input type="checkbox" id="check-katakana" checked onchange="loadCategory()"> Katakana</label>
            <label><input type="checkbox" id="check-kanji" onchange="loadCategory()"> Kanji</label>
        </div>

        <div class="card" id="card">Clique para revelar</div>

        <button onclick="anterior()">‚¨ÖÔ∏è Anterior</button>
        <button onclick="proximo()">‚û°Ô∏è Pr√≥ximo</button>
    </div>

    <script>
        const hiraganaData = [
            ["„ÅÇ", "a"], ["„ÅÑ", "i"], ["„ÅÜ", "u"], ["„Åà", "e"], ["„Åä", "o"],
            ["„Åã", "ka"], ["„Åç", "ki"], ["„Åè", "ku"], ["„Åë", "ke"], ["„Åì", "ko"],
            ["„Åï", "sa"], ["„Åó", "shi"], ["„Åô", "su"], ["„Åõ", "se"], ["„Åù", "so"],
            ["„Åü", "ta"], ["„Å°", "chi"], ["„Å§", "tsu"], ["„Å¶", "te"], ["„Å®", "to"],
            ["„Å™", "na"], ["„Å´", "ni"], ["„Å¨", "nu"], ["„Å≠", "ne"], ["„ÅÆ", "no"],
            ["„ÅØ", "ha"], ["„Å≤", "hi"], ["„Åµ", "fu"], ["„Å∏", "he"], ["„Åª", "ho"],
            ["„Åæ", "ma"], ["„Åø", "mi"], ["„ÇÄ", "mu"], ["„ÇÅ", "me"], ["„ÇÇ", "mo"],
            ["„ÇÑ", "ya"], ["„ÇÜ", "yu"], ["„Çà", "yo"],
            ["„Çâ", "ra"], ["„Çä", "ri"], ["„Çã", "ru"], ["„Çå", "re"], ["„Çç", "ro"],
            ["„Çè", "wa"], ["„Çí", "wo"], ["„Çì", "n"]
        ];

        const katakanaData = [
            ["„Ç¢", "a"], ["„Ç§", "i"], ["„Ç¶", "u"], ["„Ç®", "e"], ["„Ç™", "o"],
            ["„Ç´", "ka"], ["„Ç≠", "ki"], ["„ÇØ", "ku"], ["„Ç±", "ke"], ["„Ç≥", "ko"],
            ["„Çµ", "sa"], ["„Ç∑", "shi"], ["„Çπ", "su"], ["„Çª", "se"], ["„ÇΩ", "so"],
            ["„Çø", "ta"], ["„ÉÅ", "chi"], ["„ÉÑ", "tsu"], ["„ÉÜ", "te"], ["„Éà", "to"],
            ["„Éä", "na"], ["„Éã", "ni"], ["„Éå", "nu"], ["„Éç", "ne"], ["„Éé", "no"],
            ["„Éè", "ha"], ["„Éí", "hi"], ["„Éï", "fu"], ["„Éò", "he"], ["„Éõ", "ho"],
            ["„Éû", "ma"], ["„Éü", "mi"], ["„É†", "mu"], ["„É°", "me"], ["„É¢", "mo"],
            ["„É§", "ya"], ["„É¶", "yu"], ["„É®", "yo"],
            ["„É©", "ra"], ["„É™", "ri"], ["„É´", "ru"], ["„É¨", "re"], ["„É≠", "ro"],
            ["„ÉØ", "wa"], ["„É≤", "wo"], ["„É≥", "n"]
        ];

        // URLs
        const urls = {
            kanji: "https://docs.google.com/spreadsheets/d/e/2PACX-1vTB0TRTvlkkQYdEXeYsQrExfJTBItnnxDSk_MKunRKOck_F6Zlr68SatfP_8s_AeQ6IHPsLJ6d3xxrG/pub?gid=866008096&single=true&output=tsv",
            vocabul√°rio: "https://docs.google.com/spreadsheets/d/e/2PACX-1vTB0TRTvlkkQYdEXeYsQrExfJTBItnnxDSk_MKunRKOck_F6Zlr68SatfP_8s_AeQ6IHPsLJ6d3xxrG/pub?gid=0&single=true&output=tsv",
            perguntas: "https://docs.google.com/spreadsheets/d/e/2PACX-1vTB0TRTvlkkQYdEXeYsQrExfJTBItnnxDSk_MKunRKOck_F6Zlr68SatfP_8s_AeQ6IHPsLJ6d3xxrG/pub?gid=1456289432&single=true&output=tsv",
            descanso: "https://docs.google.com/spreadsheets/d/e/2PACX-1vTB0TRTvlkkQYdEXeYsQrExfJTBItnnxDSk_MKunRKOck_F6Zlr68SatfP_8s_AeQ6IHPsLJ6d3xxrG/pub?gid=578594546&single=true&output=tsv"
        };

        let data = [];
        let index = 0;
        let showingBack = 0;
        let currentCategory = "letras";

        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }

        async function mudarCategoria(cat, btn) {
            // Permitir recarregar letras se mudar checkbox
            if (currentCategory === cat && cat !== 'letras') return;

            currentCategory = cat;

            document.querySelectorAll(".tab-btn").forEach(b => b.classList.remove("active"));
            if (btn) btn.classList.add("active");

            // Mostrar/Esconder op√ß√µes de letras
            const options = document.getElementById("letras-options");
            if (cat === "letras") {
                options.classList.add("visible");
            } else {
                options.classList.remove("visible");
            }

            await loadCategory();
        }

        async function loadCategory() {
            if (currentCategory === "letras") {
                data = [];
                const hira = document.getElementById("check-hiragana").checked;
                const kata = document.getElementById("check-katakana").checked;
                const kanji = document.getElementById("check-kanji").checked;

                if (hira) data = [...data, ...hiraganaData];
                if (kata) data = [...data, ...katakanaData];

                if (kanji) {
                    try {
                        const res = await fetch(urls.kanji);
                        const text = await res.text();
                        const kanjiData = text.trim().split("\n").map(l => l.split("\t"));
                        data = [...data, ...kanjiData];
                    } catch (e) {
                        console.error("Erro ao carregar Kanji", e);
                    }
                }

                if (data.length === 0) {
                    alert("Selecione pelo menos uma op√ß√£o!");
                    return;
                }

                shuffleArray(data);
            } else {
                const url = urls[currentCategory];
                const res = await fetch(url);
                const text = await res.text();
                data = text.trim().split("\n").map(l => l.split("\t"));

                if (currentCategory !== 'descanso') {
                    shuffleArray(data);
                }
            }

            index = 0;
            showingBack = 0;
            mostrarCard();
        }

        function proximo() {
            index = (index + 1) % data.length;
            showingBack = 0;
            mostrarCard();
        }

        function mostrarCard() {
            const card = document.getElementById("card");
            if (data.length === 0) {
                card.innerText = "Nenhum dado carregado";
                return;
            }
            if (showingBack) {
                card.innerText = data[index][1];
                card.style.fontSize = "1.5rem";
            } else {
                card.innerText = data[index][0];
                card.style.fontSize = "3rem";
            }
        }

        document.getElementById("card").onclick = () => {
            showingBack = !showingBack;
            mostrarCard();
        };

        function anterior() {
            index = (index - 1 + data.length) % data.length;
            showingBack = 0;
            mostrarCard();
        }

        function createStars() {
            for (let i = 0; i < 150; i++) {
                let star = document.createElement("div");
                star.classList.add("stars");
                star.style.left = Math.random() * 100 + "vw";
                star.style.top = Math.random() * 100 + "vh";
                star.style.animationDuration = (Math.random() * 2 + 1) + "s";
                document.body.appendChild(star);
            }
        }
        createStars();

        loadCategory();

    </script>
</body>

</html>