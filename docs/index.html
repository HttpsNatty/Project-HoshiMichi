<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <title>HoshiMichi ‚Ä¢ Caminho das Estrelas</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="icon"
        href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><path d='M50 15 L61 40 L87 40 L66 57 L74 82 L50 66 L26 82 L34 57 L13 40 L39 40 Z' fill='%23FFD700'/></svg>">
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: 'Outfit', sans-serif;
            background: radial-gradient(circle at center, #101835 0%, #050a18 100%);
            overflow: hidden;
            color: white;
            text-align: center;
        }

        .stars {
            width: 2px;
            height: 2px;
            background: white;
            position: absolute;
            animation: twinkle 2s infinite ease-in-out;
            opacity: 0.8;
        }

        @keyframes twinkle {
            0% {
                opacity: 0.3;
            }

            50% {
                opacity: 1;
            }

            100% {
                opacity: 0.3;
            }
        }

        .logo-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: 15px;
        }

        .logo-svg {
            width: 45px;
            height: 45px;
            margin-bottom: 5px;
            filter: drop-shadow(0 0 10px rgba(255, 215, 0, 0.5));
        }

        h1 {
            font-weight: 700;
            font-size: 2.2rem;
            margin: 0;
            background: linear-gradient(135deg, #ffffff 0%, #a2b1ff 100%);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            letter-spacing: 1px;
        }

        h1 ruby {
            -webkit-text-fill-color: initial;
            color: white;
        }

        h1 rt {
            font-size: 1rem;
            color: #ffd700;
            letter-spacing: 2px;
            font-weight: 400;
        }

        .romaji {
            font-size: 1rem;
            color: #b0b8d4;
            display: block;
            margin-top: -5px;
            font-weight: 400;
            text-transform: lowercase;
        }

        .slogan {
            font-size: 1.1rem;
            color: #ffd700;
            font-weight: 300;
            letter-spacing: 2px;
            margin-top: 5px;
            opacity: 0.9;
        }

        .card {
            background: rgba(255, 255, 255, 0.05);
            padding: 50px;
            border-radius: 24px;
            backdrop-filter: blur(12px);
            width: 360px;
            margin: auto;
            font-size: 1.5rem;
            min-height: 200px;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            border: 1px solid rgba(255, 255, 255, 0.15);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .card:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateY(-5px);
            border-color: rgba(255, 215, 0, 0.3);
            box-shadow: 0 15px 40px rgba(255, 215, 0, 0.1);
        }

        button {
            background: #1e2d5a;
            border: none;
            padding: 10px 20px;
            margin: 15px;
            border-radius: 10px;
            cursor: pointer;
            color: white;
            font-size: 1rem;
            transition: 0.2s;
        }

        button:hover {
            background: #2d47a1;
        }

        .tab-container {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }

        .tab-btn {
            background: rgba(30, 45, 90, 0.6);
            border: 1px solid rgba(255, 255, 255, 0.1);
            padding: 12px 24px;
            border-radius: 50px;
            cursor: pointer;
            color: #b0b8d4;
            font-size: 1.1rem;
            transition: 0.3s;
        }

        .tab-btn:hover {
            background: rgba(45, 71, 161, 0.4);
            color: white;
            transform: translateY(-2px);
        }

        .tab-btn.active {
            background: #4556a1;
            color: white;
            border-color: #ffd700;
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.3);
            transform: scale(1.05);
        }

        #footer {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            font-size: 0.9rem;
            color: #b0b8d4;
            background: rgba(10, 15, 36, 0.8);
            backdrop-filter: blur(10px);
            border-top: 1px solid rgba(255, 143, 177, 0.3);
            transition: 0.3s;
            padding: 6px 0;
            z-index: 1000;
        }

        #footer:hover {
            background: rgba(10, 15, 36, 0.95);
            border-top-color: rgba(255, 143, 177, 0.6);
        }

        #footer a {
            color: #ff8fb1;
            /* Rosa N√©bula harmonioso */
            text-decoration: none;
            font-weight: 600;
            transition: 0.3s;
            position: relative;
        }

        #footer a:hover {
            color: #ffb8d1;
            text-shadow: 0 0 10px rgba(255, 143, 177, 0.5);
        }

        #footer a::after {
            content: '';
            position: absolute;
            width: 0;
            height: 1px;
            bottom: -2px;
            left: 0;
            background-color: #ff8fb1;
            transition: 0.3s;
        }

        #footer a:hover::after {
            width: 100%;
        }

        .main-layout {
            display: flex;
            justify-content: center;
            align-items: flex-start;
            gap: 40px;
            max-width: 1100px;
            margin: 0 auto;
            min-height: 420px;
        }

        .card-section {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
        }

        .side-filters {
            width: 240px;
            max-height: 380px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 10px;
            text-align: left;
            padding-right: 12px;
            scrollbar-width: thin;
            scrollbar-color: rgba(255, 255, 255, 0.2) transparent;
        }

        /* Scrollbar customizado */
        .side-filters::-webkit-scrollbar {
            width: 6px;
        }

        .side-filters::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.02);
            border-radius: 10px;
        }

        .side-filters::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 10px;
        }

        .side-filters::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        .options-container {
            display: none;
            flex-direction: column;
            gap: 10px;
            color: #b0b8d4;
            font-size: 0.95rem;
        }

        .options-container.visible {
            display: flex;
        }

        #dynamic-filters {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .options-container label {
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            background: rgba(255, 255, 255, 0.03);
            padding: 8px 12px;
            border-radius: 10px;
            transition: 0.2s;
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        .options-container label:hover {
            background: rgba(255, 255, 255, 0.08);
            border-color: rgba(69, 86, 161, 0.4);
            color: white;
        }

        .options-container input[type="checkbox"] {
            accent-color: #4556a1;
            width: 18px;
            height: 18px;
            cursor: pointer;
        }

        @media (max-width: 800px) {
            .main-layout {
                flex-direction: column;
                gap: 20px;
                min-height: auto;
                align-items: center;
            }

            .side-filters {
                width: 100%;
                max-height: 180px;
                flex-direction: row;
                flex-wrap: wrap;
                justify-content: center;
                padding-right: 0;
            }

            .options-container {
                flex-direction: row;
                flex-wrap: wrap;
                justify-content: center;
            }

            #dynamic-filters {
                flex-direction: row;
                flex-wrap: wrap;
                justify-content: center;
            }

            h1 {
                font-size: 1.8rem;
            }

            .card {
                width: 300px;
                padding: 40px;
                min-height: 150px;
            }
        }

        @media (max-width: 600px) {
            h1 {
                font-size: 1.8rem;
            }

            .card {
                width: 280px;
                padding: 30px;
                min-height: 160px;
            }

            .tab-btn {
                padding: 8px 16px;
                font-size: 0.9rem;
            }

            .options-container {
                font-size: 0.85rem;
                gap: 10px;
            }
        }
    </style>
</head>

<body>

    <div id="starfield"></div>

    <div class="container" style="position: relative; z-index: 100; padding: 15px 20px;">
        <div class="logo-container">
            <svg class="logo-svg" viewBox="0 0 100 100" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path
                    d="M50 5L61.2257 39.541H97.4759L68.1251 60.918L79.3508 95.459L50 74.082L20.6492 95.459L31.8749 60.918L2.52414 39.541H38.7743L50 5Z"
                    fill="#FFD700" />
                <circle cx="50" cy="50" r="45" stroke="#FFD700" stroke-opacity="0.2" stroke-width="1" />
            </svg>
            <h1>
                <ruby>ÊòüÈÅì<rt>„Åª„Åó„Åø„Å°</rt></ruby>
                <span class="romaji">hoshimichi</span>
            </h1>
            <div class="slogan">seu estudo √© o caminho guiado pelas estrelas</div>
        </div>

        <div class="tab-container">
            <button class="tab-btn active" onclick="mudarCategoria('letras', this)">‚≠ê „ÅÇ „Ç¢</button>
            <button class="tab-btn" onclick="mudarCategoria('n√∫meros', this)">üî¢ N√∫meros</button>
            <button class="tab-btn" onclick="mudarCategoria('vocabul√°rio', this)">üìñ Vocabul√°rio</button>
            <!-- <button class="tab-btn" onclick="mudarCategoria('perguntas', this)">üß† Perguntas</button> -->
        </div>

        <div class="main-layout">
            <div class="side-filters">
                <div class="options-container visible" id="letras-options">
                    <label><input type="checkbox" id="check-hiragana" checked onchange="loadCategory()">
                        Hiragana</label>
                    <label><input type="checkbox" id="check-katakana" checked onchange="loadCategory()">
                        Katakana</label>
                    <label><input type="checkbox" id="check-kanji" onchange="loadCategory()"> Kanji</label>
                </div>

                <div class="options-container" id="n√∫meros-options">
                    <label><input type="checkbox" id="check-numero" checked onchange="loadCategory()"> N√∫mero</label>
                    <div id="dynamic-filters-n√∫meros"></div>
                </div>

                <div class="options-container" id="vocabul√°rio-options">
                    <div id="dynamic-filters-vocabul√°rio"></div>
                </div>
            </div>

            <div class="card-section">
                <div class="card" id="card">Clique para revelar</div>
                <div class="controls-container">
                    <button onclick="anterior()">‚¨ÖÔ∏è Anterior</button>
                    <button onclick="proximo()">‚û°Ô∏è Pr√≥ximo</button>
                </div>
            </div>
        </div>
    </div>
    <div id="footer">
        Desenvolvido por
        <a href="https://github.com/HttpsNatty" target="_blank">Natty</a>
    </div>

    <script>
        const hiraganaData = [
            ["„ÅÇ", "a"], ["„ÅÑ", "i"], ["„ÅÜ", "u"], ["„Åà", "e"], ["„Åä", "o"],
            ["„Åã", "ka"], ["„Åç", "ki"], ["„Åè", "ku"], ["„Åë", "ke"], ["„Åì", "ko"],
            ["„Åï", "sa"], ["„Åó", "shi"], ["„Åô", "su"], ["„Åõ", "se"], ["„Åù", "so"],
            ["„Åü", "ta"], ["„Å°", "chi"], ["„Å§", "tsu"], ["„Å¶", "te"], ["„Å®", "to"],
            ["„Å™", "na"], ["„Å´", "ni"], ["„Å¨", "nu"], ["„Å≠", "ne"], ["„ÅÆ", "no"],
            ["„ÅØ", "ha"], ["„Å≤", "hi"], ["„Åµ", "fu"], ["„Å∏", "he"], ["„Åª", "ho"],
            ["„Åæ", "ma"], ["„Åø", "mi"], ["„ÇÄ", "mu"], ["„ÇÅ", "me"], ["„ÇÇ", "mo"],
            ["„ÇÑ", "ya"], ["„ÇÜ", "yu"], ["„Çà", "yo"],
            ["„Çâ", "ra"], ["„Çä", "ri"], ["„Çã", "ru"], ["„Çå", "re"], ["„Çç", "ro"],
            ["„Çè", "wa"], ["„Çí", "wo"], ["„Çì", "n"]
        ];

        const katakanaData = [
            ["„Ç¢", "a"], ["„Ç§", "i"], ["„Ç¶", "u"], ["„Ç®", "e"], ["„Ç™", "o"],
            ["„Ç´", "ka"], ["„Ç≠", "ki"], ["„ÇØ", "ku"], ["„Ç±", "ke"], ["„Ç≥", "ko"],
            ["„Çµ", "sa"], ["„Ç∑", "shi"], ["„Çπ", "su"], ["„Çª", "se"], ["„ÇΩ", "so"],
            ["„Çø", "ta"], ["„ÉÅ", "chi"], ["„ÉÑ", "tsu"], ["„ÉÜ", "te"], ["„Éà", "to"],
            ["„Éä", "na"], ["„Éã", "ni"], ["„Éå", "nu"], ["„Éç", "ne"], ["„Éé", "no"],
            ["„Éè", "ha"], ["„Éí", "hi"], ["„Éï", "fu"], ["„Éò", "he"], ["„Éõ", "ho"],
            ["„Éû", "ma"], ["„Éü", "mi"], ["„É†", "mu"], ["„É°", "me"], ["„É¢", "mo"],
            ["„É§", "ya"], ["„É¶", "yu"], ["„É®", "yo"],
            ["„É©", "ra"], ["„É™", "ri"], ["„É´", "ru"], ["„É¨", "re"], ["„É≠", "ro"],
            ["„ÉØ", "wa"], ["„É≤", "wo"], ["„É≥", "n"]
        ];

        // URLs
        const urls = {
            kanji: "https://docs.google.com/spreadsheets/d/e/2PACX-1vTB0TRTvlkkQYdEXeYsQrExfJTBItnnxDSk_MKunRKOck_F6Zlr68SatfP_8s_AeQ6IHPsLJ6d3xxrG/pub?gid=866008096&single=true&output=tsv",
            n√∫meros: "https://docs.google.com/spreadsheets/d/e/2PACX-1vTB0TRTvlkkQYdEXeYsQrExfJTBItnnxDSk_MKunRKOck_F6Zlr68SatfP_8s_AeQ6IHPsLJ6d3xxrG/pub?gid=578594546&single=true&output=tsv",
            vocabul√°rio: "https://docs.google.com/spreadsheets/d/e/2PACX-1vTB0TRTvlkkQYdEXeYsQrExfJTBItnnxDSk_MKunRKOck_F6Zlr68SatfP_8s_AeQ6IHPsLJ6d3xxrG/pub?gid=0&single=true&output=tsv",
            perguntas: "https://docs.google.com/spreadsheets/d/e/2PACX-1vTB0TRTvlkkQYdEXeYsQrExfJTBItnnxDSk_MKunRKOck_F6Zlr68SatfP_8s_AeQ6IHPsLJ6d3xxrG/pub?gid=1456289432&single=true&output=tsv",
        };

        let data = [];
        let index = 0;
        let showingBack = 0;
        let currentCategory = "letras";

        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }

        async function mudarCategoria(cat, btn) {
            // Permitir recarregar categorias com filtros
            if (currentCategory === cat && cat !== 'letras' && cat !== 'n√∫meros') return;

            currentCategory = cat;

            document.querySelectorAll(".tab-btn").forEach(b => b.classList.remove("active"));
            if (btn) btn.classList.add("active");

            // Esconder todos os containers de op√ß√µes primeiro
            document.querySelectorAll(".options-container").forEach(opt => opt.classList.remove("visible"));

            // Mostrar o container correto
            if (cat === "letras") {
                document.getElementById("letras-options").classList.add("visible");
            } else if (cat === "n√∫meros") {
                document.getElementById("n√∫meros-options").classList.add("visible");
            } else if (cat === "vocabul√°rio") {
                document.getElementById("vocabul√°rio-options").classList.add("visible");
            }

            await loadCategory();
        }

        async function loadCategory() {
            if (currentCategory === "letras") {
                data = [];
                const hira = document.getElementById("check-hiragana").checked;
                const kata = document.getElementById("check-katakana").checked;
                const kanji = document.getElementById("check-kanji").checked;

                if (hira) data = [...data, ...hiraganaData];
                if (kata) data = [...data, ...katakanaData];

                if (kanji) {
                    try {
                        const res = await fetch(urls.kanji);
                        const text = await res.text();
                        const kanjiData = text.trim().split("\n").map(l => l.split("\t"));
                        data = [...data, ...kanjiData];
                    } catch (e) {
                        console.error("Erro ao carregar Kanji", e);
                    }
                }

                if (data.length === 0) {
                    alert("Selecione pelo menos uma op√ß√£o!");
                    return;
                }

                shuffleArray(data);
            } else if (currentCategory === "n√∫meros") {
                try {
                    const res = await fetch(urls.n√∫meros);
                    const text = await res.text();
                    const rawData = text.trim().split("\n")
                        .map(l => l.split("\t"))
                        .filter(row => row.length >= 5 && (row[0].trim() !== "" || row[1].trim() !== ""));

                    gerarCheckboxes(rawData, "dynamic-filters-n√∫meros");

                    const filtrosAtivos = {};
                    filtrosAtivos["basico"] = document.getElementById("check-numero").checked;

                    document.querySelectorAll("#dynamic-filters-n√∫meros input[type=checkbox]").forEach(cb => {
                        filtrosAtivos[cb.dataset.grupo] = cb.checked;
                    });

                    data = rawData.filter(row => {
                        const grupoRaw = row[4].trim().toLowerCase();
                        const grupo = grupoRaw.normalize("NFD").replace(/[\u0300-\u036f]/g, "");
                        return filtrosAtivos[grupo];
                    }).map(row => {
                        return [row[0], `${row[1]} (${row[2]})`];
                    });

                    if (data.length === 0) {
                        alert("Selecione pelo menos uma op√ß√£o de filtros!");
                        return;
                    }

                    shuffleArray(data);
                } catch (e) {
                    console.error("Erro ao carregar N√∫meros", e);
                }
            } else if (currentCategory === "vocabul√°rio") {
                try {
                    const res = await fetch(urls.vocabul√°rio);
                    const text = await res.text();
                    const rawData = text.trim().split("\n")
                        .map(l => l.split("\t"))
                        .filter(row => row.length >= 4 && (row[0].trim() !== "" || row[1].trim() !== ""));

                    console.log("Dados brutos de Vocabul√°rio:", rawData);
                    gerarCheckboxes(rawData, "dynamic-filters-vocabul√°rio");

                    const filtrosAtivos = {};
                    document.querySelectorAll("#dynamic-filters-vocabul√°rio input[type=checkbox]").forEach(cb => {
                        filtrosAtivos[cb.dataset.grupo] = cb.checked;
                    });

                    data = rawData.filter(row => {
                        const grupoRaw = row[3].trim().toLowerCase();
                        const grupo = grupoRaw.normalize("NFD").replace(/[\u0300-\u036f]/g, "");
                        return filtrosAtivos[grupo];
                    }).map(row => {
                        const kanji = row[0].trim();
                        const hira = row[1].trim();
                        const trad = row[2].trim();

                        // Se n√£o tem kanji (ou se o kanji √© igual ao hiragana), faz s√≥ 2 passos
                        if (!kanji || kanji === hira) return [hira, trad];

                        // Caminho: Kanji -> Hiragana -> Tradu√ß√£o
                        return [kanji, hira, trad];
                    });

                    if (data.length === 0) {
                        alert("Selecione pelo menos uma op√ß√£o de filtros!");
                        return;
                    }

                    shuffleArray(data);
                } catch (e) {
                    console.error("Erro ao carregar Vocabul√°rio", e);
                }
            } else {
                const url = urls[currentCategory];
                const res = await fetch(url);
                const text = await res.text();
                data = text.trim().split("\n").map(l => l.split("\t"));

                shuffleArray(data);
            }

            index = 0;
            showingBack = 0;
            mostrarCard();
        }

        function proximo() {
            index = (index + 1) % data.length;
            showingBack = 0;
            mostrarCard();
        }

        function mostrarCard() {
            const card = document.getElementById("card");
            if (!data || data.length === 0) {
                card.innerText = "Nenhum dado carregado";
                return;
            }

            const currentCard = data[index];
            const currentPhase = Math.min(showingBack, currentCard.length - 1);

            card.innerText = currentCard[currentPhase];

            // Ajuste de fonte din√¢mico baseado na fase e conte√∫do
            if (currentPhase === 0 && currentCard.length > 2) {
                card.style.fontSize = "4rem"; // Kanji destaque
            } else if (currentPhase === currentCard.length - 1) {
                card.style.fontSize = "1.6rem"; // Tradu√ß√£o final
            } else {
                card.style.fontSize = "2.8rem"; // Hiragana/Katakana
            }
        }

        function gerarCheckboxes(rawData, containerId) {
            const container = document.getElementById(containerId);

            if (container.innerHTML !== "") return;

            const grupos = new Set();
            rawData.forEach(row => {
                if (row.length < 4) return;
                const colIndex = containerId === "dynamic-filters-vocabul√°rio" ? 3 : 4;
                let grupo = row[colIndex].trim().toLowerCase()
                    .normalize("NFD").replace(/[\u0300-\u036f]/g, "");
                if (containerId === "dynamic-filters-n√∫meros" && grupo === "basico") return;

                grupos.add(grupo);
            });

            console.log(`Grupos identificados para ${containerId}:`, Array.from(grupos));

            grupos.forEach(grupo => {
                const label = document.createElement("label");
                label.innerHTML = `
                    <input type="checkbox" data-grupo="${grupo}" checked onchange="loadCategory()">
                    ${grupo.charAt(0).toUpperCase() + grupo.slice(1)}
                `;
                container.appendChild(label);
            });
        }

        document.getElementById("card").onclick = () => {
            showingBack++;
            if (showingBack >= data[index].length) {
                showingBack = 0;
            }
            mostrarCard();
        };

        function anterior() {
            index = (index - 1 + data.length) % data.length;
            showingBack = 0;
            mostrarCard();
        }

        function createStars() {
            for (let i = 0; i < 150; i++) {
                let star = document.createElement("div");
                star.classList.add("stars");
                star.style.left = Math.random() * 100 + "vw";
                star.style.top = Math.random() * 100 + "vh";
                star.style.animationDuration = (Math.random() * 2 + 1) + "s";
                document.body.appendChild(star);
            }
        }
        createStars();

        loadCategory();

    </script>
</body>

</html>